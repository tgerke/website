922-38-17-1
467-403
42+18
467-60
xtabs(~case_control+study, data=geno_list)
white<-geno_list[geno_list$race=="Caucasian",]
xtabs(~case_control+study, data=white)
non_glioma<-white[!(white$study=="Glioma" & white$case_control==1),]
xtabs(~case_control+study, data=non_glioma)
no_exclusions<-non_glioma[non_glioma$exclusion==0 | is.na(non_glioma$exclusion),]
table(no_exclusions$case_control)
xtabs(~race+case_control+study, data=combined_interview_dataset)
47+7
table(pass$race)
467-42-18
47-42
407-5
geno1<-geno_list[geno_list$case_control==1 & geno_list$study=="Meningioma",]
geno1<-geno1[!duplicated(geno1$study_id),]
geno2<-geno1[geno1$`Sample Status`=="Pass",]
geno3<-geno2[geno2$exclusion==0 | is.na(geno2$exclusion),]
geno3<-geno3[!is.na(geno3$study_id),]
table(geno3$race)
42+6
48+18
467-66
467-47-47-1
467-47-17-1
467-403
48+18+1
67-64
467-46-17-2
467-47-17-2
467-47-18
467-48-18
467-47-18-1
467-46-16-2
.libPaths(c("~/Documents/Rpackages",.libPaths()))
library(readr)
forUK <- read_csv("/Volumes/NO NAME/Brain/meningioma/forUK.csv")
View(forUK)
403+866
library(readr)
geno_list <- read_csv("/Volumes/NO NAME/Brain/meningioma/geno_list.csv")
View(geno_list)
xtabs(~case_control+study, data=geno_list)
white<-geno_list[geno_list$race=="Caucasian",]
xtabs(~case_control+study, data=white)
non_glioma<-white[!(white$study=="Glioma" & white$case_control==1),]
xtabs(~case_control+study, data=non_glioma)
no_exclusions<-non_glioma[non_glioma$exclusion==0 | is.na(non_glioma$exclusion) |non_glioma$exclusion==1,]
table(no_exclusions$case_control)
pass<-no_exclusions[no_exclusions$`Sample Status`=="Pass",]
table(pass$case_control)
pass<-pass[!is.na(pass$study_id),]
table(pass$case_control)
pass <- pass[order(pass$study_id, pass$dQC), ]
pass<-pass[ !duplicated(pass$study_id), ]
table(pass$case_control)
load("/Volumes/NO NAME/Brain/meningioma/Glioma.RData")
genotyped<-combined_interview_dataset[combined_interview_dataset$study_id %in% pass$study_id,]
hispanic<-genotyped[genotyped$ethnicity!="Non Hispanic",]
european<-pass[!(pass$study_id  %in% hispanic$study_id),]
table(european$case_control)
family<-genotyped[(genotyped$control_group=="Friend/Family Control" |
genotyped$control_group=="Sibling Control"),]
no_fam<-european[!(european$study_id %in% family$study_id),]
table(no_fam$case_control)
mening_cases<-no_fam
mening_clinical<-genotyped[genotyped$study_id %in% mening_cases$study_id,]
summary(mening_clinical$age_consented)
mening_clinical$age_group2<-NA
mening_clinical$age_group2<-cut(mening_clinical$age_consented,c(18,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95))
age<-mening_clinical[,c("study_id","age_group2")]
mening_cases2<-merge(mening_cases,age,by="study_id")
for_alex<-mening_cases2[,c("study_id","Best Array","Internal Pico (ng/uL)","CV%","dQC","QC CR",
"Cluster CR","Het Rate","gender","case_control","age_group2")]
View(for_alex)
table(for_alex$case_control)
404+866
write.csv(for_alex, "/Volumes/NO NAME/Brain/meningioma/forUK.csv",row.names = FALSE)
library(readr)
forUK <- read_csv("/Volumes/NO NAME/Brain/meningioma/forUK.csv")
View(forUK)
.libPaths(c("~/Documents/Rpackages",.libPaths()))
library(readr)
forUK <- read_csv("/Volumes/NO NAME/Brain/meningioma/forUK.csv")
View(forUK)
controls<-forUK[forUK$case_control==0,]
controls<-controls$study_id
write.csv(controls,"/Volumes/data/ukb/EganData/noah_tables.csv",row.names = FALSE)
write.csv(controls,"/Volumes/Lab_Gerke/ukb/EganData/noah_tables.csv",row.names = FALSE)
write.csv(controls,"/Volumes/Lab_Gerke/ukb/EganData/noah_tables/meningioma_controls.csv",row.names = FALSE)
.libPaths(c("~/Documents/Rpackages",.libPaths()))
library(readr)
geno_list <- read_csv("/Volumes/NO NAME/Brain/meningioma/geno_list.csv")
View(geno_list)
xtabs(~case_control+study, data=geno_list)
white<-geno_list[geno_list$race=="Caucasian",]
xtabs(~case_control+study, data=white)
non_glioma<-white[!(white$study=="Glioma" & white$case_control==1),]
xtabs(~case_control+study, data=non_glioma)
no_exclusions<-non_glioma[non_glioma$exclusion==0 | is.na(non_glioma$exclusion) |non_glioma$exclusion==1,]
table(no_exclusions$case_control)
pass<-no_exclusions[no_exclusions$`Sample Status`=="Pass",]
table(pass$case_control)
pass<-pass[!is.na(pass$study_id),]
table(pass$case_control)
pass <- pass[order(pass$study_id, pass$dQC), ]
pass<-pass[ !duplicated(pass$study_id), ]
table(pass$case_control)
load("/Volumes/NO NAME/Brain/meningioma/Glioma.RData")
genotyped<-combined_interview_dataset[combined_interview_dataset$study_id %in% pass$study_id,]
hispanic<-genotyped[genotyped$ethnicity=="Hispanic",]
european<-pass[!(pass$study_id  %in% hispanic$study_id),]
table(european$case_control)
family<-genotyped[(genotyped$control_group=="Friend/Family Control" |
genotyped$control_group=="Sibling Control"),]
no_fam<-european[!(european$study_id %in% family$study_id),]
table(no_fam$case_control)
mening_cases<-no_fam
mening_clinical<-genotyped[genotyped$study_id %in% mening_cases$study_id,]
summary(mening_clinical$age_consented)
mening_clinical$age_group2<-NA
mening_clinical$age_group2<-cut(mening_clinical$age_consented,c(18,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95))
age<-mening_clinical[,c("study_id","age_group2")]
mening_cases2<-merge(mening_cases,age,by="study_id")
for_alex<-mening_cases2[,c("study_id","Best Array","Internal Pico (ng/uL)","CV%","dQC","QC CR",
"Cluster CR","Het Rate","gender","case_control","age_group2")]
table(for_alex$case_control)
table(hispanic$race)
table(genotyped$ethnicity)
xtabs(~ethnicity+race,data=genotyped)
468-46-14-2
922-38-16-1
write.csv(for_alex, "/Volumes/NO NAME/Brain/meningioma/forUK.csv",row.names = FALSE)
chr22_raw_hic <- read.table("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.RAWobserved",sep="\t", header=FALSE)
chr22_raw_hic <- read.table("/Volumes/data/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.RAWobserved",sep="\t", header=FALSE)
chr22_raw_hic <- read.table("/Volumes/data/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.RAWobserved.txt",sep="\t", header=FALSE)
chr22_raw_hic <- read.table("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.RAWobserved.txt",sep="\t", header=FALSE)
chr22_raw_hic <- read.table("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.RAWobserved",sep="\t", header=FALSE)
chr22_raw_hic <- read.table("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.RAWobserved",sep="\t", header=FALSE)
.libPaths(c("~/Documents/Rpackages",.libPaths()))
chr22_raw_hic <- read.table("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.RAWobserved",sep="\t", header=FALSE)
library(readr)
chr22_raw_hic <- read_delim("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr22/MAPQGE30/chr22_5kb.RAWobserved",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
View(chr22_raw_hic)
chr22_norm_hic <- read.delim("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.KRnorm", "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
chr22_norm_hic <- read_delim("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.KRnorm", "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
View(chr22_norm_hic)
library(readr)
chr22_norm_hic <- read_delim("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr22/MAPQGE30/chr22_5kb.KRnorm",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
View(chr22_norm_hic)
chr22_raw_hic$X4<-chr22_norm_hic[((chr22_raw_hic$X1/5000)+1),1]
View(chr22_raw_hic)
chr22_raw_hic$X5<-chr22_norm_hic[((chr22_raw_hic$X2/5000)+1),1]
chr22_raw_hic$X4<-ifelse(is.nan(chr22_raw_hic$X4$X1),1,chr22_raw_hic$X4$X1)
View(chr22_raw_hic)
chr22_raw_hic$X5<-ifelse(is.nan(chr22_raw_hic$X5$X1),1,chr22_raw_hic$X5$X1)
chr22_raw_hic$normalized<-(chr22_raw_hic$X3/(chr22_raw_hic$X4*chr22_raw_hic$X5)) #calculates normalized values
View(chr22_raw_hic)
summary(chr22_raw_hic$normalized)
summary(chr22_raw_hic[chr22_raw_hic$normalized>=2.4,])
norm2<-scale(chr22_raw_hic$normalized)
View(norm2)
summary(norm2$V1)
summary(norm2)
chr22_raw_hic$normalized800<-ifelse(chr22_raw_hic$normalized>=800,800,chr22_raw_hic$normalized)
View(chr22_raw_hic)
p <- ggplot(chr22_raw_hic, aes(X1, X2)) + geom_tile(aes(fill = normalized800),colour = "white") + scale_fill_gradient(low = "blue",high = "red")
library(ggplot2)
p <- ggplot(chr22_raw_hic, aes(X1, X2)) + geom_tile(aes(fill = normalized800),colour = "white") + scale_fill_gradient(low = "blue",high = "red")
plot(p)
p <- ggplot(chr22_raw_hic, aes(X1, X2)) + geom_tile(aes(fill = normalized800),colour = "red") + scale_fill_gradient(low = "blue",high = "red")
plot(p)
chr22_norm_hic <- read_delim("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/500kb_resolution_intrachromosomal/
chr22/MAPQGE30/chr22_5kb.KRnorm", "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
p <- ggplot(chr22_raw_hic, aes(X1, X2)) + geom_tile(aes(fill = normalized800)) + scale_fill_gradient(low = "blue",high = "red")
plot(p)
p <- ggplot(chr22_raw_hic, aes(X1, X2)) + geom_tile(aes(fill = normalized800),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
chr22_raw_hic$normalized50<-ifelse(chr22_raw_hic$normalized>=50,50,chr22_raw_hic$normalized)
p <- ggplot(chr22_raw_hic, aes(X1, X2)) + geom_tile(aes(fill = normalized50),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
chr22_raw_hic$normalized10<-ifelse(chr22_raw_hic$normalized>=10,10,chr22_raw_hic$normalized)
p <- ggplot(chr22_raw_hic, aes(X1, X2)) + geom_tile(aes(fill = normalized10),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
p <- ggplot(chr22_raw_hic[chr22_raw_hic$X1<=30000000 & chr22_raw_hic$X2<=30000000, ], aes(X1, X2)) + geom_tile(aes(fill = normalized10),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
p <- ggplot(chr22_raw_hic[chr22_raw_hic$X1<=25000000 & chr22_raw_hic$X2<=25000000, ], aes(X1, X2)) + geom_tile(aes(fill = normalized10),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
p <- ggplot(chr22_raw_hic[chr22_raw_hic$X1<=25000000 & chr22_raw_hic$X2<=25000000, ], aes(X1, X2)) + geom_tile(aes(fill = normalized50),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
summary(chr22_raw_hic$X3)
chr22_raw_hic$raw10<-ifelse(chr22_raw_hic$X3>=10,10,chr22_raw_hic$X3)
p <- ggplot(chr22_raw_hic[chr22_raw_hic$X1<=25000000 & chr22_raw_hic$X2<=25000000, ], aes(X1, X2)) + geom_tile(aes(fill = raw10),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
p <- ggplot(chr22_raw_hic[chr22_raw_hic$X1<=20000000 & chr22_raw_hic$X2<=20000000, ], aes(X1, X2)) + geom_tile(aes(fill = raw10),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
p <- ggplot(chr22_raw_hic[chr22_raw_hic$X1<=20000000 & chr22_raw_hic$X2<=20000000, ], aes(X1, X2)) + geom_tile(aes(fill = X3),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
p <- ggplot(chr22_raw_hic[chr22_raw_hic$X1<=20000000 & chr22_raw_hic$X2<=20000000, ], aes(X1, X2)) + geom_tile(aes(fill = raw10),colour="white") + scale_fill_gradient(low = "white",high = "purple")
plot(p)
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",4,"_CEU.txt")))
library(data.table)
library("data.table", lib.loc="~/Documents/Rpackages")
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",4,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr4.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr4.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",5,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr5.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr5.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",6,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr6.RData")
View(ld.data)
dim(ld.data[ld.data$V7<0.1,])
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",7,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr7.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr7.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",8,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr8.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr8.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",9,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr9.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr9.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",10,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr10.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr10.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",11,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr11.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr11.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",12,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr12.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr12.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",13,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr13.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr13.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",14,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr14.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr14.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",15,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr15.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr15.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",16,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr16.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr16.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",17,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr17.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr17.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",18,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr18.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr18.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",19,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr19.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr19.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",20,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr20.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr20.RData"))
system.time(ld.data<-fread(paste0("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr",21,"_CEU.txt")))
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr21.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr21.RData"))
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr22.RData"))
View(ld.data)
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr22.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr22.RData"))
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr21.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr21.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr21.RData"))
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr20.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr20.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr20.RData"))
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr19.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
View(ld.data)
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr19.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr18.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr18.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr17.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr17.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr16.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr16.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr15.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr15.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr14.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr14.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr13.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr13.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr12.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr12.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr11.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr11.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr10.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr10.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr9.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr9.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr8.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr8.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr7.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr7.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr6.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr6.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr5.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr5.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr4.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr4.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr3.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr3.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr2.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr2.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr1.RData"))
ld.data<-ld.data[,c("V1","V2","V4","V5","V7")]
save(ld.data,file="/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr1.RData")
system.time(load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/ld_chr22.RData"))
View(ld.data)
shiny::runApp('/Volumes/Lab_Gerke/ShinyApps/LD_HIC')
i<-22
raw_hic <- read_delim(paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr",i,"/MAPQGE30/chr",i,"_5kb.RAWobserved"), "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
View(raw_hic)
norm_hic <- read_delim(paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr",i,"/MAPQGE30/chr",i,"_5kb.KRnorm"), "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
View(norm_hic)
print(norm_hic)
raw_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr",i,"/MAPQGE30/chr",i,"_5kb.RAWobserved"), "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
norm_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr",i,"/MAPQGE30/chr",i,"_5kb.KRnorm"), "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/
chr",i,"/MAPQGE30/chr",i,"_5kb.RAWobserved")
paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.RAWobserved")
raw_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.RAWobserved"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
norm_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.KRnorm"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
raw_hic$X4<-norm_hic[((raw_hic$X1/5000)+1),1] #makes first vector
raw_hic$X5<-norm_hic[((raw_hic$X2/5000)+1),1] #makes second vector
raw_hic$X4<-ifelse(is.nan(raw_hic$X4$X1),1,raw_hic$X4$X1)
raw_hic$X5<-ifelse(is.nan(raw_hic$X5$X1),1,raw_hic$X5$X1)
raw_hic$normalized<-(raw_hic$X3/(raw_hic$X4*raw_hic$X5))
View(raw_hic)
raw_hic<-raw_hic[,c("X1","X2","X3","normalized")]
colnames(raw_hic)<-c("loc1","loc2","raw","normal")
View(raw_hic)
for(i in 1:22){
raw_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.RAWobserved"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
norm_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.KRnorm"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
raw_hic$X4<-norm_hic[((raw_hic$X1/5000)+1),1] #makes first vector
raw_hic$X5<-norm_hic[((raw_hic$X2/5000)+1),1] #makes second vector
raw_hic$X4<-ifelse(is.nan(raw_hic$X4$X1),1,raw_hic$X4$X1)
raw_hic$X5<-ifelse(is.nan(raw_hic$X5$X1),1,raw_hic$X5$X1)
raw_hic$normalized<-(raw_hic$X3/(raw_hic$X4*raw_hic$X5))
raw_hic<-raw_hic[,c("X1","X2","X3","normalized")]
colnames(raw_hic)<-c("loc1","loc2","raw","normal")
save(raw_hic,file=paste0("/Volumes/Lab_Gerke/Hi-C/Jordan/Rao_normalized_data/chr",i,"_hic.RData"))
rm(raw_hic,norm_hic)
print(paste0("Completed chromosome: ",i))
}
i<-9
raw_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.RAWobserved"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
norm_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.KRnorm"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.KRnorm")
norm_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.VCnorm"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
raw_hic$X4<-norm_hic[((raw_hic$X1/5000)+1),1] #makes first vector
raw_hic$X5<-norm_hic[((raw_hic$X2/5000)+1),1] #makes second vector
raw_hic$X4<-ifelse(is.nan(raw_hic$X4$X1),1,raw_hic$X4$X1)
raw_hic$X5<-ifelse(is.nan(raw_hic$X5$X1),1,raw_hic$X5$X1)
raw_hic$normalized<-(raw_hic$X3/(raw_hic$X4*raw_hic$X5))
raw_hic<-raw_hic[,c("X1","X2","X3","normalized")]
colnames(raw_hic)<-c("loc1","loc2","raw","normal")
save(raw_hic,file=paste0("/Volumes/Lab_Gerke/Hi-C/Jordan/Rao_normalized_data/chr",i,"_hic.RData"))
rm(raw_hic,norm_hic)
print(paste0("Completed chromosome: ",i))
for(i in 10:22){
raw_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.RAWobserved"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
norm_hic <- read_delim(file=paste0("/Volumes/Lab_Gerke/Hi-C/Rao/IMR90/5kb_resolution_intrachromosomal/chr",i,"/MAPQGE30/chr",i,"_5kb.KRnorm"),
"\t",escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
raw_hic$X4<-norm_hic[((raw_hic$X1/5000)+1),1] #makes first vector
raw_hic$X5<-norm_hic[((raw_hic$X2/5000)+1),1] #makes second vector
raw_hic$X4<-ifelse(is.nan(raw_hic$X4$X1),1,raw_hic$X4$X1)
raw_hic$X5<-ifelse(is.nan(raw_hic$X5$X1),1,raw_hic$X5$X1)
raw_hic$normalized<-(raw_hic$X3/(raw_hic$X4*raw_hic$X5))
raw_hic<-raw_hic[,c("X1","X2","X3","normalized")]
colnames(raw_hic)<-c("loc1","loc2","raw","normal")
save(raw_hic,file=paste0("/Volumes/Lab_Gerke/Hi-C/Jordan/Rao_normalized_data/chr",i,"_hic.RData"))
rm(raw_hic,norm_hic)
print(paste0("Completed chromosome: ",i))
}
load("/Volumes/Lab_Gerke/ShinyApps/LD_HIC/Data/chr22_hic.RData")
runApp('/Volumes/Lab_Gerke/ShinyApps/LD_HIC')
library(shiny)
library(shinydashboard)
library(data.table)
library(biomaRt)
library(plyr)
library(dplyr)
library(ggplot2)
library(labeling)
library(ggbio)
library(GenomicRanges)
install.packages("biomaRt")
source("https://bioconductor.org/biocLite.R")
biocLite("biomaRt")
source("https://bioconductor.org/biocLite.R")
biocLite("GenomicRanges")
library(shiny)
library(shinydashboard)
install.packages("shinydashboard")
library(data.table)
library(shinydashboard)
library(biomaRt)
library(plyr)
library(dplyr)
library(ggplot2)
library(labeling)
library(ggbio)
install.packages("ggbio")
source("https://bioconductor.org/biocLite.R")
biocLite("ggbio")
runApp()
runApp('/Volumes/Lab_Gerke/ShinyApps/LD_HIC')
runApp('/Volumes/Lab_Gerke/ShinyApps/LD_HIC')
setwd("~/Dropbox/websites/website/travisgerke/")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
?blogdown::build_site
?blogdown:::serve_site
?blogdown::build_site
build_site
blogdown::build_site
getOption('blogdown.method')
